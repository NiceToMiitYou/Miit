{"version":3,"sources":["team/component/user/user-list-item-roles.jsx"],"names":[],"mappings":"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","file":"team/component/user/user-list-item-roles.js","sourcesContent":["(function() {\n    var UserStore, TeamStore, TeamActions;\n\n    MiitComponents.UserListItemRoles = React.createClass({\n        getDefaultProps: function() {\n            return {\n                text: {\n                    admin:  'Administrateur',\n                    user:   'Utilisateur',\n                    remove: 'Supprimer'\n                },\n                user: {\n                    id:    '',\n                    roles: []\n                }\n            };\n        },\n\n        getInitialState: function() {\n            return {\n                loading: false\n            };\n        },\n\n        componentWillMount: function() {\n            if(!UserStore) {\n                UserStore = MiitApp.get('miit-user-store');\n            }\n            if(!TeamStore) {\n                TeamStore = MiitApp.get('miit-team-store');\n            }\n            if(!TeamActions) {\n                TeamActions = MiitApp.get('miit-team-actions');\n            }\n        },\n\n        componentDidMount: function() {\n            // Promote\n            TeamStore.addPromotedListener(this._onPromoted);\n            TeamStore.addNotPromotedListener(this._onError);\n            // Demote\n            TeamStore.addDemotedListener(this._onDemoted);\n            TeamStore.addNotDemotedListener(this._onError);\n        },\n\n        componentWillUnmount: function() {\n            // Promote\n            TeamStore.removePromotedListener(this._onPromoted);\n            TeamStore.removeNotPromotedListener(this._onError);\n            // Demote\n            TeamStore.removeDemotedListener(this._onDemoted);\n            TeamStore.removeNotDemotedListener(this._onError);\n        },\n\n        _stopLoading: function() {\n            if(this.isMounted()) {\n                this.setState({\n                    loading: false\n                });\n            }\n        },\n\n        _onPromoted: function() {\n            this._stopLoading();\n        },\n\n        _onDemoted: function() {\n            this._stopLoading();\n        },\n\n        _onError: function() {\n            this._stopLoading();\n            console.log('Can not promote or demote the user.');\n        },\n\n        toggleRole: function(role, cb) {\n            var action = 'promote';\n\n            if(this.props.user.roles.indexOf(role) >= 0) {\n                action = 'demote';\n            }\n\n            TeamActions[action](this.props.user.id, [role]);\n        },\n\n        handleClick: function(action, e) {\n            e.preventDefault();\n\n            // Don't load twice\n            if(this.state.loading)\n                return;\n\n            var IAmAdmin    = UserStore.isAdmin();\n            var userIsOwner = UserStore.isOwner(this.props.user);\n            var userIsAdmin = UserStore.isAdmin(this.props.user);\n            var userIsMe    = UserStore.isItMe(this.props.user);\n\n            // Check if I am an admin and not myself or an owner\n            if(!IAmAdmin || userIsMe || userIsOwner)\n                return;\n\n            // Check if I want to remove an admin\n            if(action === 'REMOVE' && userIsAdmin)\n                return;\n\n            this.setState({\n                loading: true\n            });\n\n            switch(action) {\n                case 'ADMIN':\n                case 'USER':\n                    this.toggleRole(action);\n                    break;\n\n                case 'REMOVE':\n                    TeamActions.remove(this.props.user.id);\n                    break;\n            }\n        },\n\n        render: function() {\n            var IAmAdmin    = UserStore.isAdmin();\n\n            if(false === IAmAdmin) {\n                return null;\n            }\n\n            var userIsAdmin = UserStore.isAdmin(this.props.user);\n            var userIsUser  = UserStore.isUser(this.props.user);\n            var userIsMe    = UserStore.isItMe(this.props.user);\n\n            var user_active = classNames({\n                disable: !IAmAdmin || userIsMe || userIsAdmin,\n                active:  userIsUser\n            });\n\n            var admin_active = classNames({\n                disable: !IAmAdmin || userIsMe,\n                active:  userIsAdmin\n            });\n\n            var remove_active = classNames({\n                disable: !IAmAdmin || userIsMe || userIsAdmin\n            });\n\n            return (\n                <span className=\"miit-component user-list-item-roles\">\n                    <div className=\"checkbox-field pull-left\" onClick={this.handleClick.bind(this, 'USER')} >\n                        <label>\n                            <input type=\"checkbox\" className=\"option-input checkbox\" checked={userIsUser} readOnly/>\n                            {this.props.text.user}\n                        </label>\n                    </div>\n\n                    <div className=\"checkbox-field pull-left ml20\" onClick={this.handleClick.bind(this, 'ADMIN')} >\n                        <label>\n                            <input type=\"checkbox\" className=\"option-input checkbox\" checked={userIsAdmin} readOnly/>\n                            {this.props.text.admin}\n                        </label>\n                    </div>\n\n                    <button onClick={this.handleClick.bind(this, 'REMOVE')} className='btn btn-danger ml20' disabled={remove_active}>\n                        <i className=\"fa fa-trash-o\"></i>\n                    </button>\n                </span>\n            );\n        }\n    });\n})();"],"sourceRoot":"/source/"}