!function(e,t,n){window.MiitComponents={};var i=function(){function e(){var e={},t={};this.register=function(t,n){e[t]=n},this.resolve=function(){var n,i,a,s=[];return"string"==typeof arguments[0]?(n=arguments[1],i=arguments[0].replace(/ /g,"").split(","),a=arguments[2]||{}):Array.isArray(arguments[0])?(n=arguments[1],i=arguments[0],a=arguments[2]||{}):(n=arguments[0],i=n.toString().match(/^function\s*[^\(]*\(\s*([^\)]*)\)/m)[1].replace(/ /g,"").split(","),a=arguments[1]||{}),function(){for(var r=Array.prototype.slice.call(arguments,0),o=0;o<i.length;o++){var l=i[o];t[l]||"function"!=typeof e[l]||(t[l]=e[l]()),s.push(t[l]&&""!==l?t[l]:r.shift())}return n.apply(a||{},s)}},this.get=function(e){var t=this.resolve(e,function(e){return e});return t()}}return new e}();(function(){"use strict";function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var i=e.prototype,a=this,s=a.EventEmitter;i.getListeners=function(e){var t,n,i=this._getEvents();if(e instanceof RegExp){t={};for(n in i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n])}else t=i[e]||(i[e]=[]);return t},i.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},i.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},i.addListener=function(e,n){var i,a=this.getListenersAsObject(e),s="object"==typeof n;for(i in a)a.hasOwnProperty(i)&&-1===t(a[i],n)&&a[i].push(s?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(e){return this.getListeners(e),this},i.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},i.removeListener=function(e,n){var i,a,s=this.getListenersAsObject(e);for(a in s)s.hasOwnProperty(a)&&(i=t(s[a],n),-1!==i&&s[a].splice(i,1));return this},i.off=n("removeListener"),i.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},i.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},i.manipulateListeners=function(e,t,n){var i,a,s=e?this.removeListener:this.addListener,r=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)s.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(a=t[i])&&("function"==typeof a?s.call(this,i,a):r.call(this,i,a));return this},i.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if(e instanceof RegExp)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(e,t){var n,i,a,s,r=this.getListenersAsObject(e);for(a in r)if(r.hasOwnProperty(a))for(i=r[a].length;i--;)n=r[a][i],n.once===!0&&this.removeListener(e,n.listener),s=n.listener.apply(this,t||[]),s===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},i.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},i._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},i._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return a.EventEmitter=s,e},"function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof module&&module.exports?module.exports=e:a.EventEmitter=e}).call(this),function(){Array.prototype.remove=function(){for(var e,t,n=arguments,i=n.length;i&&this.length;)for(e=n[--i];-1!==(t=this.indexOf(e));)this.splice(t,1);return this},Array.prototype.indexBy=function(e,t){for(var n in this)if(this[n]&&this[n][e]===t)return n;return-1},Array.prototype.findBy=function(e,t){var n=this.indexBy(e,t);return n>=0?this[n]:null},Array.prototype.sortBy=function(e,t){return this.sort(function(n,i){if(n&&i)return n[e]<i[e]?"desc"===t?1:-1:n[e]>i[e]?"desc"===t?-1:1:0}),this},Array.prototype.removeBy=function(e,t){for(var n=this.indexBy(e,t);n>=0;n=this.indexBy(e,t))delete this[n]},Array.prototype.remove=function(e){for(var t=this.indexOf(e);t>=0;t=this.indexOf(e))delete this[t]},Array.prototype.removeAll=function(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){this.remove(e)}.bind(this))},Array.prototype.merge=function(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){this.indexOf(e)<0&&this.push(e)}.bind(this))}}(),window.classNames=function(){"use strict";for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e+=" "+n;else if(Array.isArray(n))e+=" "+classNames.apply(null,n);else if("object"===i)for(var a in n)n.hasOwnProperty(a)&&n[a]&&(e+=" "+a)}}return e.substr(1)},function(){function e(e){return"add"+e.dashToCapitalize()+"Listener"}function t(e){return"remove"+e.dashToCapitalize()+"Listener"}function n(e){return"emit"+e.dashToCapitalize()}EventEmitter.prototype.generateNamedFunctions=function(i){var a=this;this[e(i)]=function(e){a.on(i,e)},this[t(i)]=function(e){a.removeListener(i,e)},this[n(i)]=function(){a.emit(i)}}}(),function(){var e=i.resolve([],function(){return function(e){var t,n={};if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n}});i.register("key-mirror",e)}(),function(){function e(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var t=i.resolve([],function(){return Object.assign||function(t,n){for(var i,a,s=e(t),r=1;r<arguments.length;r++){i=arguments[r],a=Object.keys(Object(i));for(var o=0;o<a.length;o++)s[a[o]]=i[a[o]]}return s}});i.register("object-assign",t)}(),function(){String.prototype.capitalize=function(){return this.toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()})},String.prototype.dashToCapitalize=function(){return this.replace(/_/g," ").capitalize().replace(/ /g,"")}}(),function(){var e=i.resolve(["key-mirror"],function(e){return{ActionTypes:e({NEW_NOTIFICATION:null})}});i.register("miit-notifications-constants",e)}(),function(){var e=i.resolve(["key-mirror"],function(e){return{ActionTypes:e({CHANGE_MAIN_PAGE_COMPLETED:null,CHANGE_MIIT_PAGE_COMPLETED:null,CHANGE_APPLICATION_PAGE_COMPLETED:null})}});i.register("miit-page-constants",e)}(),function(){var e=i.resolve(["key-mirror"],function(e){return{ActionTypes:e({REFRESH_USERS_COMPLETED:null,UPDATE_TEAM_COMPLETED:null,UPDATE_TEAM_ERROR:null,INVITE_USER_COMPLETED:null,INVITE_USER_ERROR:null,DEMOTE_USER_COMPLETED:null,DEMOTE_USER_ERROR:null,PROMOTE_USER_COMPLETED:null,PROMOTE_USER_ERROR:null,REMOVE_USER_COMPLETED:null,REMOVE_USER_ERROR:null})}});i.register("miit-team-constants",e)}(),function(){var e=i.resolve(["key-mirror"],function(e){return{ActionTypes:e({REFRESH_USER_COMPLETED:null,LOGIN_USER_COMPLETED:null,LOGIN_USER_ERROR:null,LOGOUT_USER_COMPLETED:null,CHANGE_PASSWORD_USER_COMPLETED:null,CHANGE_PASSWORD_USER_ERROR:null,UPDATE_USER_COMPLETED:null,UPDATE_USER_ERROR:null})}});i.register("miit-user-constants",e)}(),function(){var e=i.resolve(["key-mirror"],function(e){return{ActionTypes:e({REFRESH_USER_STATUS:null,UPDATE_USER_STATUS:null})}});i.register("miit-user-status-constants",e)}(),function(){var e=i.resolve(["miit-dispatcher","miit-notifications-constants"],function(e,t){var n=t.ActionTypes;return{"new":function(t,i){var a={type:n.NEW_NOTIFICATION,category:t||"info",text:i};e.dispatch(a)}}});i.register("miit-notifications-actions",e)}(),function(){var e=i.resolve(["miit-dispatcher","miit-page-constants"],function(e,t){var n=t.ActionTypes;return{changeMainPage:function(t){var i={type:n.CHANGE_MAIN_PAGE_COMPLETED,mainPage:t};e.dispatch(i)},changeApplicationPage:function(t,i,a){var s={type:n.CHANGE_APPLICATION_PAGE_COMPLETED,mainPage:t,applicationPage:a};e.dispatch(s)}}});i.register("miit-page-actions",e)}(),function(){var e=i.resolve(["miit-dispatcher","miit-team-constants","miit-realtime","miit-team-request"],function(e,t,n,i){var a=t.ActionTypes,s=function(t,n,i){var s={type:i.done?a.PROMOTE_USER_COMPLETED:a.PROMOTE_USER_ERROR,id:t,roles:n};e.dispatch(s)},r=function(t,n,i){var s={type:i.done?a.DEMOTE_USER_COMPLETED:a.DEMOTE_USER_ERROR,id:t,roles:n};e.dispatch(s)},o=function(t,n){var i={type:n.done?a.REMOVE_USER_COMPLETED:a.REMOVE_USER_ERROR,id:t};e.dispatch(i)},l=function(t){var n={type:t.done?a.INVITE_USER_COMPLETED:a.INVITE_USER_ERROR,user:t.user};e.dispatch(n)},c=function(t,n,i){var s={type:i.done?a.UPDATE_TEAM_COMPLETED:a.UPDATE_TEAM_ERROR,name:t,"public":n};e.dispatch(s)},m=function(t){var n={type:a.REFRESH_USERS_COMPLETED,users:t.users};e.dispatch(n)};n.on("team:users",m);var u={refresh:function(){n.send("team:users")},update:function(e,t){i.update(e,t,c.bind({},e,t))},invite:function(e){i.invite(e,l)},promote:function(e,t){i.promote(e,t,s.bind({},e,t))},demote:function(e,t){i.demote(e,t,r.bind({},e,t))},remove:function(e){i.remove(e,o.bind({},e))}};return u});i.register("miit-team-actions",e)}(),function(){var e=i.resolve(["miit-dispatcher","miit-realtime","miit-user-constants"],function(e,t,n){var i=n.ActionTypes;return t.on("login:token",function(t){if(t.user){var n={type:i.REFRESH_USER_COMPLETED,token:t.token,user:t.user};e.dispatch(n)}}),t.on("login:password",function(t){var n={type:t.done?i.LOGIN_USER_COMPLETED:i.LOGIN_USER_ERROR,user:t.user,token:t.token};e.dispatch(n)}),t.on("user:password",function(t){var n={type:t.done?i.CHANGE_PASSWORD_USER_COMPLETED:i.CHANGE_PASSWORD_USER_ERROR};e.dispatch(n)}),t.on("user:update",function(t){var n={type:t.done?i.UPDATE_USER_COMPLETED:i.UPDATE_USER_ERROR,name:t.name};e.dispatch(n)}),{login:function(e,n){t.send("login:password",{email:e,password:n})},logout:function(){var t={type:i.LOGOUT_USER_COMPLETED};e.dispatch(t)},check:function(e){e&&t.send("login:token",{token:e})},changePassword:function(e,n){t.send("user:password",{old:e,"new":n})},update:function(e){t.send("user:update",{name:e})}}});i.register("miit-user-actions",e)}(),function(){var e=i.resolve(["miit-dispatcher","miit-user-status-constants","miit-realtime"],function(e,t,n){function i(t){var n={type:s.UPDATE_USER_STATUS,status:t.status};e.dispatch(n)}function a(t){r=!1;var n={type:s.REFRESH_USER_STATUS,status:t.status};e.dispatch(n)}var s=t.ActionTypes,r=!1;n.on("user:status",i),n.on("users:status",a);var o={refresh:function(){!1===r&&(r=!0,n.send("users:status"))}};return o.refresh(),o});i.register("miit-user-status-actions",e)}(),function(){var e=i.resolve(["miit-utils"],function(e){return{newsletter:function(t,n){e.ajax.send("/newsletter",{email:t},n)},registration:function(t,n,i){e.ajax.send("/register",{email:t,name:n},i)}}});i.register("miit-home-request",e)}(),function(){var e=i.resolve(["miit-utils"],function(e){return{users:function(t){e.ajax.send("/app/team/users",t)},invite:function(t,n){e.ajax.send("/app/team/invite",{email:t},n)},update:function(t,n,i){var a={name:t};n&&(a["public"]="public"),e.ajax.send("/app/team/update",a,i)},promote:function(t,n,i){e.ajax.send("/app/team/promote",{id:t,roles:n},i)},demote:function(t,n,i){e.ajax.send("/app/team/demote",{id:t,roles:n},i)},remove:function(t,n){e.ajax.send("/app/team/remove",{id:t},n)}}});i.register("miit-team-request",e)}(),function(){function e(e,n){t.push(e),setTimeout(function(){t.shift(),n()},5e3)}var t=[],n=i.resolve(["object-assign","key-mirror","miit-utils","miit-dispatcher","miit-notifications-constants"],function(n,i,a,s,r){var o=r.ActionTypes,l=i({NOTIFICATION_ADDED:null,NOTIFICATION_REMOVED:null}),c=n({},EventEmitter.prototype,{getNotifications:function(){return t}});return c.generateNamedFunctions(l.NOTIFICATION_ADDED),c.generateNamedFunctions(l.NOTIFICATION_REMOVED),c.dispatchToken=s.register(function(t){switch(t.type){case o.NEW_NOTIFICATION:var n={id:a.generator.guid(),type:t.category,text:t.text};e(n,c.emitNotificationRemoved),c.emitNotificationAdded()}}),c});i.register("miit-notifications-store",n)}(),function(){var e=i.resolve(["object-assign","key-mirror","miit-dispatcher","miit-storage","miit-router","miit-page-constants","miit-user-store","miit-team-store"],function(e,t,n,i,a,s,r,o){var l,c,m=s.ActionTypes,u=i.create("pages"),p=t({MAIN_PAGE_CHANGED:null,APPLICATION_PAGE_CHANGED:null}),d=e({},EventEmitter.prototype,{getCurrentMainPage:function(){var e=l;return!1===o.isPublic()&&!1===r.isLoggedIn()?e="login":!0===r.isLoggedIn()&&"login"===e&&(e="home"),u.get("main-"+e)},getCurrentApplicationPage:function(){return u.get("application-"+c)},registerMainPage:function(e,t){u.set("main-"+e,t)},registerApplicationPage:function(e,t){u.set("application-"+e,t)}});d.generateNamedFunctions(p.MAIN_PAGE_CHANGED),d.generateNamedFunctions(p.APPLICATION_PAGE_CHANGED);var f=function(e){e.mainPage&&e.mainPage!==l&&(l=e.mainPage,d.emitMainPageChanged())},h=function(e){e.applicationPage&&e.applicationPage!==c&&(c=e.applicationPage,d.emitApplicationPageChanged()),f(e)};return d.dispatchToken=n.register(function(e){switch(e.type){case m.CHANGE_APPLICATION_PAGE_COMPLETED:h(e);break;case m.CHANGE_MAIN_PAGE_COMPLETED:f(e)}}),d});i.register("miit-page-store",e)}(),function(){function e(e,t){c.name=e,c["public"]=t}function t(e){if(e){var t=m.indexBy("id",e.id||"");0>t&&m.push(e)}}function n(e){m=e||[]}function a(e,t){return m.filter(function(n){var i=!1;return i=t?n.roles.indexOf(e)<0:n.roles.indexOf(e)>=0})}function s(e){return m.findBy("id",e)}function r(e){var t=m.indexBy("id",e);t>=0&&delete m[t]}function o(e,t){var n=m.indexBy("id",e);m[n]&&Array.isArray(m[n].roles)&&m[n].roles.merge(t)}function l(e,t){var n=m.indexBy("id",e);m[n]&&Array.isArray(m[n].roles)&&m[n].roles.removeAll(t)}var c,m=[],u=i.resolve(["object-assign","key-mirror","miit-storage","miit-dispatcher","miit-user-store","miit-team-constants"],function(i,u,p,d,f,h){var E=h.ActionTypes,g=u({TEAM_UPDATED:null,TEAM_NOT_UPDATED:null,REFRESHED:null,NOT_REFRESHED:null,INVITED:null,NOT_INVITED:null,PROMOTED:null,NOT_PROMOTED:null,DEMOTED:null,NOT_DEMOTED:null,REMOVED:null,NOT_REMOVED:null}),v=i({},EventEmitter.prototype,{getTeam:function(){return c||(c=p.shared.get("team")),c||{}},isPublic:function(){return!0===this.getTeam()["public"]},getUser:function(e){return s(e)},getUsers:function(){return m},getUsersByRole:function(e,t){return a(e,t)}});return v.generateNamedFunctions(g.REFRESHED),v.generateNamedFunctions(g.NOT_REFRESHED),v.generateNamedFunctions(g.TEAM_UPDATED),v.generateNamedFunctions(g.TEAM_NOT_UPDATED),v.generateNamedFunctions(g.INVITED),v.generateNamedFunctions(g.NOT_INVITED),v.generateNamedFunctions(g.PROMOTED),v.generateNamedFunctions(g.NOT_PROMOTED),v.generateNamedFunctions(g.DEMOTED),v.generateNamedFunctions(g.NOT_DEMOTED),v.generateNamedFunctions(g.REMOVED),v.generateNamedFunctions(g.NOT_REMOVED),v.dispatchToken=d.register(function(i){switch(i.type){case E.REFRESH_USERS_COMPLETED:n(i.users),v.emitRefreshed();break;case E.UPDATE_TEAM_COMPLETED:e(i.name,i["public"]),v.emitTeamUpdated();break;case E.UPDATE_TEAM_ERROR:v.emitTeamNotUpdated();break;case E.INVITE_USER_COMPLETED:t(i.user),v.emitInvited();break;case E.INVITE_USER_ERROR:v.emitNotInvited();break;case E.PROMOTE_USER_COMPLETED:o(i.id,i.roles),v.emitPromoted();break;case E.PROMOTE_USER_ERROR:v.emitNotPromoted();break;case E.DEMOTE_USER_COMPLETED:l(i.id,i.roles),v.emitDemoted();break;case E.DEMOTE_USER_ERROR:v.emitNotDemoted();break;case E.REMOVE_USER_COMPLETED:r(i.id),v.emitRemoved();break;case E.REMOVE_USER_ERROR:v.emitNotRemoved()}}),v});i.register("miit-team-store",u)}(),function(){function e(e){for(var t=a.length,n=0;t>n;n++)if(a[n].userId===e.userId)return void(a[n].status=e.status);a.push(e)}function t(e){for(var t=a.length,n=0;t>n;n++)if(a[n].userId===e)return a[n].status;return"OFFLINE"}function n(e){Array.isArray(e)&&(a=e)}var a=[],s=i.resolve(["object-assign","key-mirror","miit-utils","miit-dispatcher","miit-user-status-constants"],function(i,s,r,o,l){var c=l.ActionTypes,m=s({STATUS_CHANGED:null}),u=i({},EventEmitter.prototype,{getUserStatus:function(){return a},getUserStatusByUserId:function(e){return t(e)}});return u.generateNamedFunctions(m.STATUS_CHANGED),u.dispatchToken=o.register(function(t){switch(t.type){case c.REFRESH_USER_STATUS:n(t.status),u.emitStatusChanged();break;case c.UPDATE_USER_STATUS:e(t.status),u.emitStatusChanged()}}),u});i.register("miit-user-status-store",s)}(),function(){function e(e){return function(t){var n=(t||l||{}).roles||[];return n.indexOf(e)>=0}}function t(t){return e("ANONYM")(t)}function n(e){var t=(l||{}).id||null,n=(e||{}).id||null;return t===n}function a(e){return e=e||l||{},t(e)?"Anonyme":e.name}function s(e){l.name=e}function r(e,t){l=t,c=e,m=!0,localStorage.setItem("token",c)}function o(){l=null,c=null,m=!1,localStorage.removeItem("token")}var l,c,m=!1,u=i.resolve(["object-assign","key-mirror","miit-storage","miit-dispatcher","miit-user-constants"],function(i,u,p,d,f){var h=f.ActionTypes,E=u({LOGGED_IN:null,LOGIN_ERROR:null,PASSWORD_CHANGED:null,PASSWORD_NOT_CHANGED:null,USER_UPDATED:null,USER_NOT_UPDATED:null}),g=i({},EventEmitter.prototype,{isLoggedIn:function(){return m},getUser:function(){return l||(l=p.shared.get("user")),l},getToken:function(){return c||(c=localStorage.getItem("token")),c},isOwner:e("OWNER"),isAdmin:e("ADMIN"),isUser:e("USER"),isAnonym:t,isItMe:n,getName:a});return g.generateNamedFunctions(E.LOGGED_IN),g.generateNamedFunctions(E.LOGIN_ERROR),g.generateNamedFunctions(E.PASSWORD_CHANGED),g.generateNamedFunctions(E.PASSWORD_NOT_CHANGED),g.generateNamedFunctions(E.USER_UPDATED),g.generateNamedFunctions(E.USER_NOT_UPDATED),g.dispatchToken=d.register(function(e){switch(e.type){case h.REFRESH_USER_COMPLETED:r(e.token,e.user),g.emitLoggedIn();break;case h.LOGIN_USER_COMPLETED:r(e.token,e.user),g.emitLoggedIn();break;case h.LOGIN_USER_ERROR:g.emitLoginError();break;case h.LOGOUT_USER_COMPLETED:o(),window.location.href="/";break;case h.CHANGE_PASSWORD_USER_COMPLETED:g.emitPasswordChanged();break;case h.CHANGE_PASSWORD_USER_ERROR:g.emitPasswordNotChanged();break;case h.UPDATE_USER_COMPLETED:s(e.name),g.emitUserUpdated();break;case h.UPDATE_USER_ERROR:g.emitUserNotUpdated()}}),g});i.register("miit-user-store",u)}(),function(){var e=function(){return new t.Dispatcher};i.register("miit-dispatcher",e)}(),function(){var e=i.resolve(["miit-storage","miit-user-store","miit-team-store"],function(e,t,n){var i=Primus.connect(),a=function(e){console.log(e),i.reserved(e.event)||i.emit.call(i,e.event,e)};return i.on("data",a),{send:function(e,t){t||(t={}),t.event=e,i.write(t)},sendIn:function(e,t,n){n||(n={}),n.event=t,i["in"](e).write(n)},on:function(e,t){i.on(e,t)}}});i.register("miit-realtime",e)}(),function(){var e=i.resolve(["miit-storage"],function(e){var t,i=e.create("routes");return{init:function(){t=n(i.getData()),t.configure({html5history:!0,run_handler_in_init:!0,convert_hash_in_init:!0}),t.init()},routes:i,setRoute:function(e){t&&t.setRoute(e)}}});i.register("miit-router",e)}(),function(){function e(e){var t={},n={};this.set=function(e,t,i){return n[e]=t,void 0!==i&&null!==i&&this.expire(e,i),this},this.get=function(e){return n[e]},this.expire=function(e,n){t[e]&&clearTimeout(t[e]),void 0!==n&&null!==n?t[e]=setTimeout(function(){this.remove(e)}.bind(this),n):this.remove(e)},this.remove=function(e){return delete n[e],delete t[e],this},this.clear=function(){for(var e in t)clearTimeout(t[e]);return n={},t={},this},this.getName=function(){return e},this.getData=function(){return n}}var t=i.resolve(function(){return{create:function(t){return new e(t)},shared:new e("shared")}});i.register("miit-storage",t)}(),function(){var e=i.resolve(["miit-storage"],function(e){function t(){for(var e=!1,t=0;t<l.length;t++){try{e=l[t]()}catch(n){continue}break}return e}var n=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,i=/^[a-z0-9]{4,}$/i,a=/^.{6,32}$/,s=/^[0-9a-zA-Z_\'\-\. ]{4,42}$/i,r=function(e){return function(t){return e.test(t)}},o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},l=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=function(e,n,i,a){var s=t();if(s){"function"==typeof i?(a=i,i=null):"function"==typeof n&&(a=n,n=null);var r=n?"POST":"GET";if(s.open(r,e,!0),n&&s.setRequestHeader("Content-type","application/json"),i)for(var o in i)s.setRequestHeader(o,i[o]);s.onreadystatechange=function(){if(4==s.readyState){var e;try{e=JSON.parse(s.responseText)}catch(t){}"function"==typeof a&&a(e||{},s)}},4!=s.readyState&&s.send(JSON.stringify(n))}};return{ajax:{send:c},validator:{email:r(n),password:r(a),team:r(i),user:r(s)},generator:{guid:o}}});i.register("miit-utils",e)}(),window.MiitApp=function(){var e=i.resolve(["miit-router"],function(e,t){var n="0.0.0",a="All rigths reserved to ITEvents.";return{COPYRIGTH:a,VERSION:n,get:function(e){return i.get(e)},init:function(){e.init()}}});return e()}();var a=e.createClass({displayName:"ClockFace",render:function(){var t=this.props.date,n=t.getMinutes()<10?"0":"",i=n+t.getMinutes(),a=t.getHours();return e.createElement("div",{className:"miit-component clock"},e.createElement("i",{className:"fa fa-clock-o pull-left"}),e.createElement("span",null,a,":"),e.createElement("span",null,i))}});!function(){var t;MiitComponents.Clock=e.createClass({displayName:"Clock",getInitialState:function(){return{date:new Date}},componentDidMount:function(){this.tick(),t=setInterval(function(){this.tick()}.bind(this),5e3)},componentWillUnmount:function(){clearInterval(t)},tick:function(){this.setState({date:new Date})},render:function(){return e.createElement(a,{date:this.state.date})}})}();var s=(e.createClass({displayName:"Dropdown",timeoutId:null,propTypes:{label:e.PropTypes.string.isRequired},getDefaultProps:function(){return{angle:"down"}},getInitialState:function(){return{open:!1}},toggleAngle:function(){var e=this.props.angle;return this.state.open?"up"===e?"down":"up":e},_onLeave:function(){this.isMounted()&&this.setState({open:!1})},onLeave:function(){this.timeoutId=setTimeout(this._onLeave,675)},onEnter:function(){clearTimeout(this.timeoutId)},onClick:function(){this.onEnter(),this.setState({open:!this.state.open})},render:function(){var t="fa-angle-"+this.toggleAngle(),n={open:this.state.open},i=classNames("pull-right","fa",t),a=classNames("miit-component","dropdown",n);return e.createElement("span",{onMouseLeave:this.onLeave,onMouseEnter:this.onEnter,onClick:this.onClick,className:a},e.createElement("span",{className:"dropdown-label"},this.props.label,e.createElement("i",{className:i})),e.createElement(s,{test:this.state.open},e.createElement("div",{className:"dropdown-inner"},this.props.children)))}}),e.createClass({displayName:"If",render:function(){return this.props.test?this.props.children:null}})),r={},o=e.createClass({displayName:"Link",onClick:function(e){if(this.props.onLinkClick&&this.props.onLinkClick(e),!this.props.external){e.preventDefault();var t=this.props.href||"";t=t.substr(t.indexOf("#")+1),i.get("miit-router").setRoute(t),this.setActive()}},setActive:function(){this.props.activeGroup&&this.props.activeName&&(r[this.props.activeGroup]=this.props.activeName)},render:function(){var t=this.props.className;if(this.props.activeGroup&&this.props.activeName){var n=this.props.activeGroup,i=this.props.activeName;r[n]===i&&(t=classNames(t,"active"))}return e.createElement("a",e.__spread({},this.props,{onClick:this.onClick,className:t}),this.props.children)}});!function(){MiitComponents.Loading=e.createClass({displayName:"Loading",getDefaultProps:function(){return{loading:"Chargement..."}},render:function(){return e.createElement("div",{className:"miit-component loading-container"},e.createElement("div",{className:"loading"},e.createElement("img",{src:"/img/logo-miit-outter.png"}),e.createElement("img",{className:"inner",src:"/img/logo-miit-inner.png"})),this.props.loading)}})}(),function(){var t,n;MiitComponents.CreateTeam=e.createClass({displayName:"CreateTeam",getDefaultProps:function(){return{placeholder:{email:"Votre addresse mail",team:"Le nom de votre équipe"},submit:"Créer une équipe"}},getInitialState:function(){return this.getDefaultErrors()},getDefaultErrors:function(){return{missing_email:!1,missing_team:!1,invalid_email:!1,invalid_team:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-utils")),n||(n=MiitApp.get("miit-home-request"))},handleSubmit:function(i){i.preventDefault();var a=e.findDOMNode(this.refs.email).value.trim(),s=e.findDOMNode(this.refs.team).value.trim();return this.setState(this.getDefaultErrors()),a&&s?t.validator.email(a)?t.validator.team(s)?void n.registration(a,s,function(e){e.done}):void this.setState({invalid_team:!0}):void this.setState({invalid_email:!0}):void this.setState({missing_email:!a,missing_team:!s})},render:function(){var t=classNames({invalid:this.state.missing_email||this.state.invalid_email}),n=classNames({invalid:this.state.missing_team||this.state.invalid_team});return e.createElement("form",{className:"miit-component create-team",onSubmit:this.handleSubmit},e.createElement("div",{className:"row pt20 pb20"},e.createElement("div",{className:"col-md-6 mb10"},e.createElement("div",{className:"input-field left-icon icon-transparent push0"},e.createElement("i",{className:"fa fa-envelope-o"}),e.createElement("input",{type:"text",className:t,placeholder:this.props.placeholder.email,ref:"email"}))),e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"input-field left-icon icon-transparent col5"},e.createElement("i",{className:"fa fa-users"}),e.createElement("input",{type:"text",className:n,placeholder:this.props.placeholder.team,ref:"team"})))),e.createElement("button",{type:"submit",className:"btn btn-dark mt5"},this.props.submit))}})}(),function(){var t,n;MiitComponents.NewsLetter=e.createClass({displayName:"NewsLetter",getDefaultProps:function(){return{placeholder:{email:"Votre addresse mail"},submit:"S'inscrire à la Newsletter"}},getInitialState:function(){var e=this.getDefaultErrors();return e.done=!1,e},getDefaultErrors:function(){return{missing_email:!1,invalid_email:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-utils")),n||(n=MiitApp.get("miit-home-request"))},handleSubmit:function(i){i.preventDefault();var a=e.findDOMNode(this.refs.email).value.trim();return this.setState(this.getDefaultErrors()),a?t.validator.email(a)?void n.registration(a,function(e){e.done&&this.setState({done:!0})}.bind(this)):void this.setState({invalid_email:!0}):void this.setState({missing_email:!a})},render:function(){var t=classNames({invalid:this.state.missing_email||this.state.invalid_email}),n=this.state.done;return e.createElement("form",{className:"miit-component news-letter",onSubmit:this.handleSubmit},e.createElement(s,{test:!n},e.createElement("div",{className:"row pt30 pb20"},e.createElement("div",{className:"col-md-9 mb10"},e.createElement("div",{className:t+" input-field left-icon icon-transparent push0 pt5 pb5"},e.createElement("i",{className:"fa fa-envelope-o pt5 pl5 pb5"}),e.createElement("input",{type:"text",placeholder:this.props.placeholder.email,ref:"email"}))),e.createElement("div",{className:"col-md-3 mb10"},e.createElement("button",{type:"submit",className:"btn btn-dark pl10 pr10 pt15 pb15"},this.props.submit)))),e.createElement(s,{test:n},e.createElement("div",{className:"mt30"},"Merci beaucoup pour votre confiance.")))}})}(),function(){MiitComponents.MiitHome=e.createClass({displayName:"MiitHome",getDefaultProps:function(){return{title:"Welcome",text:{users:"Utilisateurs"}}},render:function(){return e.createElement("div",{className:"container-fluid"},e.createElement("div",{className:"page-header"},e.createElement("a",{href:"#",className:"minimize-menu"},e.createElement("i",{className:"fa fa-bars"})),e.createElement("h1",null,this.props.title),e.createElement(MiitComponents.Clock,null)),e.createElement("div",{className:"sidr-right"},e.createElement("span",{className:"sr-label"},this.props.text.users),e.createElement(MiitComponents.UserList,{headers:!1,invite:!1,roles:!1,emails:!1,filtered:!1,status:!0})))}}),MiitApp.get("miit-page-store").registerMainPage("home",e.createElement(MiitComponents.MiitHome,null))}(),function(){MiitComponents.MiitLogin=e.createClass({displayName:"MiitLogin",getDefaultProps:function(){return{title:"Connexion"}},render:function(){return e.createElement("div",{className:"container-fluid"},e.createElement("div",{className:"page-header"},e.createElement("a",{href:"#",className:"minimize-menu"},e.createElement("i",{className:"fa fa-bars"})),e.createElement("h1",null,this.props.title),e.createElement(MiitComponents.Clock,null)),e.createElement(MiitComponents.UserLogin,null))}}),MiitApp.get("miit-page-store").registerMainPage("login",e.createElement(MiitComponents.MiitLogin,null))}(),function(){MiitComponents.MiitNotFound=e.createClass({displayName:"MiitNotFound",getDefaultProps:function(){return{title:"Cette page n'existe pas.",text:{home:"Retour à l'accueil"}}},render:function(){return e.createElement("div",{className:"container-fluid"},e.createElement("h1",{className:"pt25"},this.props.title),e.createElement("div",{className:"mt50"},e.createElement(o,{href:"/"},this.props.text.home)))}}),MiitApp.get("miit-page-store").registerMainPage("not-found",e.createElement(MiitComponents.MiitNotFound,null))}(),function(){var t,n;MiitComponents.MiitTeamSettings=e.createClass({displayName:"MiitTeamSettings",getDefaultProps:function(){return{text:{applications:"Applications",informations:"Informations"}}},componentWillMount:function(){t||(t=MiitApp.get("miit-user-store")),n||(n=MiitApp.get("miit-team-store"))},componentDidMount:function(){n.addTeamUpdatedListener(this._onChange)},componentWillUnmount:function(){n.removeTeamUpdatedListener(this._onChange)},_onChange:function(){this.forceUpdate()},render:function(){if(!t.isAdmin())return e.createElement(MiitComponents.MiitNotFound,null);var i=n.getTeam();return e.createElement("div",{className:"container-fluid"},e.createElement("div",{className:"page-header"},e.createElement("a",{href:"#",className:"minimize-menu"},e.createElement("i",{className:"fa fa-bars"})),e.createElement("h1",null,i.name),e.createElement(MiitComponents.Clock,null)),e.createElement("div",{className:"panel mb30 mt30"},e.createElement("h2",{className:"panel-title"},e.createElement("i",{className:"fa fa-th pull-left "})," ",this.props.text.applications),e.createElement("div",{className:"panel-content"},e.createElement("div",{className:"row"},e.createElement("ul",{className:"app-list col-md-12"},e.createElement("li",null,e.createElement("a",null,e.createElement("i",{className:"fa fa-weixin bg-blue"}),e.createElement("span",null,"Chat"))),e.createElement("li",null,e.createElement("a",null,e.createElement("i",{className:"fa fa-question bg-green"}),e.createElement("span",null,"Quizz"))),e.createElement("li",null,e.createElement("a",{className:"add-app"},e.createElement("i",{className:"fa fa-plus bg-blue-grey"}),e.createElement("span",null,"Ajouter une App"))))))),e.createElement("div",{className:"panel mt30"},e.createElement("h2",{className:"panel-title"},e.createElement("i",{className:"fa fa-info pull-left "}),this.props.text.informations),e.createElement("div",{className:"panel-content"},e.createElement("h3",{className:"mb20"},e.createElement("i",{className:"fa fa-key pull-left"})," Modifier les informations"),e.createElement(MiitComponents.TeamUpdate,null),e.createElement("h3",{className:"mt40 mb10"},e.createElement("i",{className:"fa fa-users pull-left"})," Liste des utilisateurs"),e.createElement(MiitComponents.UserList,{autoload:!0}))))}}),MiitApp.get("miit-page-store").registerMainPage("settings",e.createElement(MiitComponents.MiitTeamSettings,null));

}(),function(){var t;MiitComponents.MiitUserSettings=e.createClass({displayName:"MiitUserSettings",getDefaultProps:function(){return{text:{informations:"Informations"}}},componentWillMount:function(){t||(t=MiitApp.get("miit-user-store"))},componentDidMount:function(){t.addUserUpdatedListener(this._onChange)},componentWillUnmount:function(){t.removeUserUpdatedListener(this._onChange)},_onChange:function(){this.forceUpdate()},render:function(){if(t.isAnonym())return e.createElement(MiitComponents.MiitNotFound,null);var n=t.getUser(),i=t.getName(n);return e.createElement("div",{className:"container-fluid"},e.createElement("div",{className:"page-header"},e.createElement("a",{href:"#",className:"minimize-menu"},e.createElement("i",{className:"fa fa-bars"})),e.createElement("h1",null,i),e.createElement(MiitComponents.Clock,null)),e.createElement("div",{className:"panel mt30"},e.createElement("h2",{className:"panel-title"},e.createElement("i",{className:"fa fa-th pull-left "}),this.props.text.informations),e.createElement("div",{className:"panel-content"},e.createElement("div",{className:"row"},e.createElement("div",{className:"col-md-7 mb20"},e.createElement("h3",{className:"mb20"},e.createElement("i",{className:"fa fa-key pull-left"})," Modifier vos informations"),e.createElement(MiitComponents.UserUpdate,null)),e.createElement("div",{className:"col-md-5"},e.createElement("h3",{className:"mb20"},e.createElement("i",{className:"fa fa-key pull-left"})," Changer de mot de passe"),e.createElement(MiitComponents.UserChangePassword,null))))))}}),MiitApp.get("miit-page-store").registerMainPage("me",e.createElement(MiitComponents.MiitUserSettings,null))}(),function(){var t,n;MiitComponents.MenuHeader=e.createClass({displayName:"MenuHeader",componentWillMount:function(){t||(t=MiitApp.get("miit-team-store")),n||(n=MiitApp.get("miit-user-store"))},componentDidMount:function(){t.addTeamUpdatedListener(this._onChanged)},componentWillUnmount:function(){t.removeTeamUpdatedListener(this._onChanged)},_onChanged:function(){this.forceUpdate()},render:function(){var i=t.getTeam();return e.createElement("div",{className:"miit-component menu-header sl-header"},e.createElement(s,{test:n.isAdmin()},e.createElement(o,{href:"#/settings"},i.name," ",e.createElement("i",{className:"fa fa-cogs pull-right"}))),e.createElement(s,{test:!n.isAdmin()},e.createElement("div",null,i.name)))}})}(),function(){MiitComponents.MenuLabel=e.createClass({displayName:"MenuLabel",render:function(){var t=classNames("pull-left","fa",this.props.icon||"");return e.createElement("span",{className:"miit-component menu-label sl-label"},e.createElement("i",{className:t}),this.props.label)}})}(),function(){var t,n;MiitComponents.MenuTeam=e.createClass({displayName:"MenuTeam",getDefaultProps:function(){return{text:{user_label:"Utilisateur",my_account:"Mon compte",disconnect:"Déconnexion",connect:"Connexion",apps_label:"Applications"}}},componentWillMount:function(){t||(t=MiitApp.get("miit-user-store")),n||(n=MiitApp.get("miit-user-actions"))},render:function(){return e.createElement("div",{className:"sidr-left bg-blue-grey"},e.createElement("div",{className:"sl-wrapper"},e.createElement(MiitComponents.MenuHeader,null),e.createElement(MiitComponents.MenuLabel,{label:this.props.text.user_label}),e.createElement(MiitComponents.MenuUserProfile,null),e.createElement("ul",{className:"sl-list mb10"},e.createElement(s,{test:!t.isAnonym()},e.createElement("li",null,e.createElement(o,{href:"#/me",activeGroup:"menu-team",activeName:"me"},e.createElement("i",{className:"fa fa-cogs pull-left"})," ",this.props.text.my_account))),e.createElement(s,{test:!t.isAnonym()},e.createElement("li",null,e.createElement(o,{href:"#/logout",onLinkClick:n.logout},e.createElement("i",{className:"fa fa-sign-out pull-left"})," ",this.props.text.disconnect))),e.createElement(s,{test:t.isAnonym()},e.createElement("li",null,e.createElement(o,{href:"#/login"},e.createElement("i",{className:"fa fa-sign-in pull-left"})," ",this.props.text.connect)))),e.createElement(MiitComponents.MenuLabel,{label:this.props.text.apps_label}),e.createElement("ul",{className:"sl-list"},e.createElement("li",null,e.createElement(o,{href:"#/home",activeGroup:"menu-team",activeName:"home"},e.createElement("i",{className:"fa fa-weixin pull-left"})," Chat",e.createElement("span",{className:"notification"},"4"))),e.createElement("li",null,e.createElement(o,{href:"#/quizz",activeGroup:"menu-team",activeName:"quizz"},e.createElement("i",{className:"fa fa-question pull-left"})," Quizz")),e.createElement("li",null,e.createElement(o,{href:"#/test2/plop"},e.createElement("i",{className:"fa fa-folder-o pull-left"})," Documents",e.createElement("span",{className:"notification"},"18"))),e.createElement(s,{test:t.isAdmin()},e.createElement("li",null,e.createElement(o,{href:"/test2/plop"},e.createElement("i",{className:"fa fa-plus pull-left"})," Ajouter une App"))))))}})}(),function(){var t;MiitComponents.MenuUserProfile=e.createClass({displayName:"MenuUserProfile",getDefaultProps:function(){return{text:{logout:"Déconnexion",login:"Connexion",profile:"Modifier mon profile",team:"Modifier l'équipe"}}},componentWillMount:function(){t||(t=MiitApp.get("miit-user-store"))},componentDidMount:function(){t.addUserUpdatedListener(this._onChanged)},componentWillUnmount:function(){t.removeUserUpdatedListener(this._onChanged)},_onChanged:function(){this.forceUpdate()},render:function(){var n=t.getUser(),i=t.getName(n);return e.createElement("span",{className:"miit-component user-profile"},e.createElement("div",{className:"avatar"},e.createElement(MiitComponents.UserAvatar,{user:n})),e.createElement("span",{className:"username"},i),e.createElement("span",null,e.createElement("i",{className:"fa fa-circle-thin stat-open mr5"})," Connecté"))}})}(),function(){MiitComponents.Notification=e.createClass({displayName:"Notification",getDefaultProps:function(){return{notification:{type:"info",text:"Lorem ipsum dolor sit amet, consectetur adipiscing."}}},render:function(){var t=classNames("miit-component","notifications-container","notification-dialog","nd-"+this.props.notification.type);return e.createElement("div",{className:t},e.createElement("span",null,this.props.notification.text))}})}(),function(){var t;MiitComponents.NotificationsContainer=e.createClass({displayName:"NotificationsContainer",componentWillMount:function(){t||(t=MiitApp.get("miit-notifications-store"))},componentDidMount:function(){t.addNotificationAddedListener(this._onChanged),t.addNotificationRemovedListener(this._onChanged)},componentWillUnmount:function(){t.addNotificationRemovedListener(this._onChanged)},_onChanged:function(){this.forceUpdate()},render:function(){var n=t.getNotifications()||[];return e.createElement("div",{className:"miit-component notifications-container dialog-container"},n.map(function(t){return e.createElement(MiitComponents.Notification,{key:t.id,notification:t})}))}})}(),function(){var t,n,i;MiitComponents.TeamUpdate=e.createClass({displayName:"TeamUpdate",getDefaultProps:function(){return{placeholder:{name:"Nom de l'équipe"},text:{"public":"Publique",isPublic:"Votre Miit est publique et accessible a tout le monde via l'URL suivante","private":"Privé",isPrivate:"Votre Miit est privé et ne sera accessible qu'aux personnes de votre choix"},submit:"Modifier"}},getInitialState:function(){var e=this.getDefaultErrors();return e.value_name="",e},getDefaultErrors:function(){return{missing_name:!1,invalid_same:!1,invalid_format:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-utils")),i||(i=MiitApp.get("miit-team-store")),n||(n=MiitApp.get("miit-team-actions"));var e=i.getTeam();this.setState({value_name:e.name,value_public:e["public"]})},componentDidMount:function(){i.addTeamUpdatedListener(this._onChanged),i.addTeamNotUpdatedListener(this._onError)},componentWillUnmount:function(){i.removeTeamUpdatedListener(this._onChanged),i.removeTeamNotUpdatedListener(this._onError)},_onChanged:function(){if(this.isMounted()){var e=i.getTeam();this.setState({value_name:e.name,value_public:e["public"]})}},_onError:function(){console.log("team not updated.")},handleChange:function(e){if(e.target&&e.target.name){var t={},n="value_"+e.target.name,i=e.target.value||"";t[n]=i,this.setState(t)}},handlePublic:function(e){this.setState({value_public:e})},generateUrl:function(){return window.location.protocol+"//"+window.location.hostname+"/"},handleSubmit:function(e){e.preventDefault();var a=this.state.value_name,s=this.state.value_public,r=i.getTeam();return this.setState(this.getDefaultErrors()),a?s===r["public"]&&a===r.name?void this.setState({invalid_same:!0}):t.validator.team(a)?void n.update(a,s):void this.setState({invalid_format:!0}):void this.setState({missing_name:!a})},render:function(){var t=this.state.value_name,n=classNames({invalid:this.state.missing_name||this.state.invalid_same||this.state.invalid_format}),i=this.state.value_public;return e.createElement("form",{className:"miit-component user-update",onSubmit:this.handleSubmit},e.createElement("div",{className:"mb20"},e.createElement("input",{type:"text",className:n,value:t,placeholder:this.props.placeholder.name,onChange:this.handleChange,name:"name"})),e.createElement("div",{className:"checkbox-field mb20"},e.createElement("label",null,e.createElement("input",{type:"radio",name:"confid",className:"option-input radio",defaultChecked:i,onChange:this.handlePublic.bind(this,!0)}),this.props.text["public"]),e.createElement("label",{className:"ml40"},e.createElement("input",{type:"radio",name:"confid",className:"option-input radio",defaultChecked:!i,onChange:this.handlePublic.bind(this,!1)}),this.props.text["private"])),e.createElement(s,{test:i},e.createElement("div",{className:"mb20"},e.createElement("p",{className:"mb10"},this.props.text.isPublic),e.createElement("div",{className:"col8 col16-md"},e.createElement("div",{className:"input-field left-icon"},e.createElement("i",{className:"fa fa-link"}),e.createElement("input",{value:this.generateUrl(),type:"text",disabled:!0}))))),e.createElement(s,{test:!i},e.createElement("p",{className:"mb10"},this.props.text.isPrivate)),e.createElement("div",null,e.createElement("button",{type:"submit",className:"btn btn-info mt20"},this.props.submit)))}})}(),function(){var t;MiitComponents.UserAvatar=e.createClass({displayName:"UserAvatar",componentWillMount:function(){t||(t=MiitApp.get("miit-user-store"))},render:function(){var n,i=this.props.user||t.getUser();return i.avatar&&(n="http://www.gravatar.com/avatar/"+i.avatar+"?s=128&d=identicon"),n=n||"/img/logo-miit-light.png",e.createElement("span",{className:"miit-component user-avatar"},e.createElement("img",e.__spread({src:n},this.props)))}})}(),function(){var t,n,i;MiitComponents.UserChangePassword=e.createClass({displayName:"UserChangePassword",getDefaultProps:function(){return{placeholder:{old:"Votre mot de passe",first:"Le nouveau mot de passe",second:"Entrez le mot de passe à nouveau"},submit:"Changer le mot de passe"}},getInitialState:function(){var e=this.getDefaultErrors();return e.value_old="",e.value_first="",e.value_second="",e},getDefaultErrors:function(){return{missing_old:!1,missing_first:!1,missing_second:!1,invalid_old:!1,invalid_same:!1,invalid_repeated:!1,invalid_format:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-utils")),i||(i=MiitApp.get("miit-user-store")),n||(n=MiitApp.get("miit-user-actions"))},componentDidMount:function(){i.addPasswordChangedListener(this._onChanged),i.addPasswordNotChangedListener(this._onError)},componentWillUnmount:function(){i.removePasswordChangedListener(this._onChanged),i.removePasswordNotChangedListener(this._onError)},_onChanged:function(){this.isMounted()&&this.setState({value_old:"",value_first:"",value_second:""})},_onError:function(){console.log("password not changed.")},handleChange:function(e){if(e.target&&e.target.name){var t={},n="value_"+e.target.name,i=e.target.value||"";t[n]=i,this.setState(t)}},handleSubmit:function(e){e.preventDefault();var i=this.state.value_old,a=this.state.value_first,s=this.state.value_second;return this.setState(this.getDefaultErrors()),i&&a&&s?a!==s?void this.setState({invalid_repeated:!0}):a===i?void this.setState({invalid_same:!0}):t.validator.password(a)?void n.changePassword(i,a):void this.setState({invalid_format:!0}):void this.setState({missing_old:!i,missing_first:!a,missing_second:!s})},render:function(){var t=this.state.value_old,n=classNames({invalid:this.state.missing_old||this.state.invalid_old}),i=this.state.value_first,a=classNames({invalid:this.state.missing_first||this.state.invalid_same||this.state.invalid_format}),s=this.state.value_second,r=classNames({invalid:this.state.missing_second||this.state.invalid_repeated});return e.createElement("form",{className:"miit-component change-password",onSubmit:this.handleSubmit},e.createElement("input",{type:"password",className:n+" mb15",value:t,placeholder:this.props.placeholder.old,onChange:this.handleChange,name:"old"}),e.createElement("input",{type:"password",className:a+" mb15",value:i,placeholder:this.props.placeholder.first,onChange:this.handleChange,name:"first"}),e.createElement("input",{type:"password",className:r+" mb20",value:s,placeholder:this.props.placeholder.second,onChange:this.handleChange,name:"second"}),e.createElement("button",{className:"btn btn-warning",type:"submit"},this.props.submit))}})}(),function(){var t;MiitComponents.UserListHeader=e.createClass({displayName:"UserListHeader",getDefaultProps:function(){return{text:{avatar:"Avatar",name:"Name",email:"Email",action:"Action"},email:!0,roles:!0}},componentWillMount:function(){t||(t=MiitApp.get("miit-user-store"))},render:function(){return e.createElement("div",{className:"miit-component user-list-header"},e.createElement("span",null,this.props.text.avatar),e.createElement("span",null,this.props.text.name),e.createElement(s,{test:this.props.email&&t.isUser()},e.createElement("span",null,this.props.text.email)),e.createElement(s,{test:this.props.roles&&t.isAdmin()},e.createElement("span",null,this.props.text.action)))}})}(),function(){var t,n,i,a;MiitComponents.UserListInvite=e.createClass({displayName:"UserListInvite",getDefaultProps:function(){return{placeholder:{email:"Addresse mail"},submit:"Inviter l'utilisateur"}},getInitialState:function(){var e=this.getDefaultErrors();return e.email="",e},getDefaultErrors:function(){return{missing_email:!1,invalid_email:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-utils")),n||(n=MiitApp.get("miit-user-store")),i||(i=MiitApp.get("miit-team-store")),a||(a=MiitApp.get("miit-team-actions"))},componentDidMount:function(){i.addInvitedListener(this._onInvited),i.addNotInvitedListener(this._onError)},componentWillUnmount:function(){i.removeInvitedListener(this._onInvited),i.removeNotInvitedListener(this._onError)},handleChange:function(e){this.setState({email:e.trim()})},handleSubmit:function(e){e.preventDefault();var i=this.state.email;return this.setState(this.getDefaultErrors()),n.isAdmin()?i?t.validator.email(i)?void a.invite(i):void this.setState({invalid_email:!0}):void this.setState({missing_email:!0}):void 0},_onInvited:function(){this.setState({email:""}),"function"==typeof this.props.onInvite&&this.props.onInvite(email)},_onError:function(){console.log("Can not invite the user.")},render:function(){if(!n.isAdmin())return null;var t=classNames({invalid:this.state.missing_email||this.state.invalid_email}),i={value:this.state.email,requestChange:this.handleChange};return e.createElement("div",{className:"miit-component user-list-invite mt20"},e.createElement("form",{onSubmit:this.handleSubmit},e.createElement("div",{className:"input-field left-icon col-md-7 mb10"},e.createElement("i",{className:"fa fa-user-plus"}),e.createElement("input",{type:"text",className:t,placeholder:this.props.placeholder.email,valueLink:i})),e.createElement("button",{type:"submit",className:"btn btn-info btn-large ml15"},this.props.submit)))}})}(),function(){var t,n,i;MiitComponents.UserListItemRoles=e.createClass({displayName:"UserListItemRoles",getDefaultProps:function(){return{text:{admin:"Administrateur",user:"Utilisateur",remove:"Supprimer"},user:{id:"",roles:[]}}},getInitialState:function(){return{loading:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-user-store")),n||(n=MiitApp.get("miit-team-store")),i||(i=MiitApp.get("miit-team-actions"))},componentDidMount:function(){n.addPromotedListener(this._onPromoted),n.addNotPromotedListener(this._onError),n.addDemotedListener(this._onDemoted),n.addNotDemotedListener(this._onError)},componentWillUnmount:function(){n.removePromotedListener(this._onPromoted),n.removeNotPromotedListener(this._onError),n.removeDemotedListener(this._onDemoted),n.removeNotDemotedListener(this._onError)},_stopLoading:function(){this.isMounted()&&this.setState({loading:!1})},_onPromoted:function(){this._stopLoading()},_onDemoted:function(){this._stopLoading()},_onError:function(){this._stopLoading(),console.log("Can not promote or demote the user.")},toggleRole:function(e,t){var n="promote";this.props.user.roles.indexOf(e)>=0&&(n="demote"),i[n](this.props.user.id,[e])},handleClick:function(e,n){if(n.preventDefault(),!this.state.loading){var a=t.isAdmin(),s=t.isOwner(this.props.user),r=t.isAdmin(this.props.user),o=t.isItMe(this.props.user);if(!(!a||o||s||"REMOVE"===e&&r))switch(this.setState({loading:!0}),e){case"ADMIN":case"USER":this.toggleRole(e);break;case"REMOVE":i.remove(this.props.user.id)}}},render:function(){var n=t.isAdmin();if(!1===n)return null;var i=t.isAdmin(this.props.user),a=t.isUser(this.props.user),s=t.isItMe(this.props.user),r=(classNames({disable:!n||s||i,active:a}),classNames({disable:!n||s,active:i}),classNames({disable:!n||s||i}));return e.createElement("span",{className:"miit-component user-list-item-roles"},e.createElement("div",{className:"checkbox-field pull-left",onClick:this.handleClick.bind(this,"USER")},e.createElement("label",null,e.createElement("input",{type:"checkbox",className:"option-input checkbox",checked:a,readOnly:!0}),this.props.text.user)),e.createElement("div",{className:"checkbox-field pull-left ml20",onClick:this.handleClick.bind(this,"ADMIN")},e.createElement("label",null,e.createElement("input",{type:"checkbox",className:"option-input checkbox",checked:i,readOnly:!0}),this.props.text.admin)),e.createElement("button",{onClick:this.handleClick.bind(this,"REMOVE"),className:"btn btn-danger ml20",disabled:r},e.createElement("i",{className:"fa fa-trash-o"})))}})}(),function(){var t,n;MiitComponents.UserListItem=e.createClass({displayName:"UserListItem",getDefaultProps:function(){return{user:{id:"",name:"unknow",roles:[]},email:!0,roles:!0,status:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-user-store")),n||(n=MiitApp.get("miit-user-status-store"))},componentDidMount:function(){n.addStatusChangedListener(this._onChanged)},componentWillUnmount:function(){n.removeStatusChangedListener(this._onChanged)},_onChanged:function(){this.forceUpdate()},render:function(){var i,a=t.getName(this.props.user);if(this.props.status){var r=this.props.user.id,o=n.getUserStatusByUserId(r);i=classNames("status pl10",o.toLowerCase())}return e.createElement("div",{className:"miit-component user-list-item"},e.createElement(MiitComponents.UserAvatar,{user:this.props.user}),e.createElement("span",{className:"pl10"},a),e.createElement(s,{test:this.props.status},e.createElement("span",{className:i},e.createElement("i",{className:"icon-logo-miit"}))),e.createElement(s,{test:this.props.email&&t.isUser()},e.createElement("span",{className:"pl10"},this.props.user.email)),e.createElement(s,{test:this.props.roles&&t.isAdmin()},e.createElement(MiitComponents.UserListItemRoles,{user:this.props.user})))}})}(),function(){var t,n,i,a;MiitComponents.UserList=e.createClass({displayName:"UserList",getDefaultProps:function(){return{users:[],loading:"Chargement...",headers:!0,invite:!0,roles:!0,emails:!0,filtered:!0,status:!1}},getInitialState:function(){return{users:[],loaded:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-team-store")),n||(n=MiitApp.get("miit-team-actions")),i||(i=MiitApp.get("miit-user-status-store")),a||(a=MiitApp.get("miit-user-status-actions")),this.setState({users:t.getUsers(this.props.filtered)})},componentDidMount:function(){t.addInvitedListener(this._refresh),t.addPromotedListener(this._refresh),t.addDemotedListener(this._refresh),t.addRemovedListener(this._refresh),t.addRefreshedListener(this._refresh),n.refresh()},componentWillUnmount:function(){t.removeInvitedListener(this._refresh),t.removePromotedListener(this._refresh),t.removeDemotedListener(this._refresh),t.removeRemovedListener(this._refresh),t.removeRefreshedListener(this._refresh)},_refresh:function(){this.isMounted()&&this.setState({users:t.getUsers(this.props.filtered).sortBy("name"),loaded:!0})},render:function(){return e.createElement("div",{className:"miit-component user-list"},e.createElement(s,{test:this.props.headers},e.createElement(MiitComponents.UserListHeader,{email:this.props.emails,roles:this.props.roles})),this.state.users.map(function(t){return e.createElement(MiitComponents.UserListItem,{key:t.id,user:t,email:this.props.emails,roles:this.props.roles,status:this.props.status})}.bind(this)),e.createElement(s,{test:!this.state.loaded},e.createElement(MiitComponents.Loading,null)),e.createElement(s,{test:this.props.invite},e.createElement(MiitComponents.UserListInvite,{onInvite:this.allowRefresh})))}})}(),function(){var t,n,i,a;MiitComponents.UserLogin=e.createClass({displayName:"UserLogin",getDefaultProps:function(){return{text:{title:"Connexion au Miit"},placeholder:{email:"Adresse email",password:"Mot de passe"},submit:"Se connecter"}},getInitialState:function(){var e=this.getDefaultErrors();return e.value_email="",e.value_password="",e},getDefaultErrors:function(){return{login_error:!1,missing_email:!1,missing_password:!1,invalid_format:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-utils")),n||(n=MiitApp.get("miit-team-store")),i||(i=MiitApp.get("miit-user-store")),a||(a=MiitApp.get("miit-user-actions"))},componentDidMount:function(){i.addLoggedInListener(this._onLoggedIn),i.addLoginErrorListener(this._onError)},componentWillUnmount:function(){i.removeLoggedInListener(this._onLoggedIn),i.removeLoginErrorListener(this._onError)},_onLoggedIn:function(){this.isMounted()&&this.forceUpdate()},_onError:function(){this.isMounted()&&this.setState({login_error:!0,value_password:""})},handleChange:function(e){if(e.target&&e.target.name){var t={},n="value_"+e.target.name,i=e.target.value||"";t[n]=i,this.setState(t)}},handleSubmit:function(e){e.preventDefault();var n=this.state.value_email,i=this.state.value_password;return this.setState(this.getDefaultErrors()),n&&i?t.validator.email(n)?void a.login(n,i):void this.setState({invalid_format:!0}):void this.setState({missing_email:!n,missing_password:!i})},render:function(){if(i.isLoggedIn())return null;var t=this.state.value_email,n=classNames({invalid:this.state.missing_email||this.state.invalid_format}),a=this.state.value_password,s=classNames({invalid:this.state.missing_password});return e.createElement("span",{className:"miit-component user-login"},e.createElement("div",{className:"panel mb30 mt30"},e.createElement("h2",{className:"panel-title"},e.createElement("i",{className:"fa fa-lock pull-left "})," ",this.props.text.title),e.createElement("div",{className:"panel-content"},e.createElement("form",{onSubmit:this.handleSubmit},e.createElement("input",{type:"text",className:n+" mb15",value:t,placeholder:this.props.placeholder.email,onChange:this.handleChange,name:"email"}),e.createElement("input",{type:"password",className:s+" mb15",value:a,placeholder:this.props.placeholder.password,onChange:this.handleChange,name:"password"}),e.createElement("button",{className:"btn btn-warning",type:"submit"},this.props.submit)))))}})}(),function(){var t,n,i;MiitComponents.UserUpdate=e.createClass({displayName:"UserUpdate",getDefaultProps:function(){return{placeholder:{name:"Votre nom"},submit:"Modifier"}},getInitialState:function(){var e=this.getDefaultErrors();return e.value_name="",e},getDefaultErrors:function(){return{missing_name:!1,invalid_same:!1,invalid_format:!1}},componentWillMount:function(){t||(t=MiitApp.get("miit-utils")),i||(i=MiitApp.get("miit-user-store")),n||(n=MiitApp.get("miit-user-actions"));var e=i.getUser();this.setState({value_name:e.name})},componentDidMount:function(){i.addUserUpdatedListener(this._onChanged),i.addUserNotUpdatedListener(this._onError)},componentWillUnmount:function(){i.removeUserUpdatedListener(this._onChanged),i.removeUserNotUpdatedListener(this._onError)},_onChanged:function(){if(this.isMounted()){var e=i.getUser();this.setState({value_name:e.name})}},_onError:function(){console.log("user not updated.")},handleChange:function(e){if(e.target&&e.target.name){var t={},n="value_"+e.target.name,i=e.target.value||"";t[n]=i,this.setState(t)}},handleSubmit:function(e){e.preventDefault();var a=this.state.value_name,s=i.getUser();return this.setState(this.getDefaultErrors()),a?a===s.name?void this.setState({invalid_same:!0}):t.validator.user(a)?void n.update(a):void this.setState({invalid_format:!0}):void this.setState({missing_name:!a})},render:function(){var t=this.state.value_name,n=classNames({invalid:this.state.missing_name||this.state.invalid_same||this.state.invalid_format});return e.createElement("form",{className:"miit-component user-update",onSubmit:this.handleSubmit},e.createElement("input",{type:"text",className:n,value:t,placeholder:this.props.placeholder.name,onChange:this.handleChange,name:"name"}),e.createElement("button",{type:"submit",className:"btn btn-info mt20"},this.props.submit))}})}(),function(){var t,n,i,a,s,o="home";MiitComponents.TeamApp=e.createClass({displayName:"TeamApp",getInitialState:function(){return{page:null}},componentWillMount:function(){n||(n=MiitApp.get("miit-user-store")),i||(i=MiitApp.get("miit-user-actions"),i.check(n.getToken())),a||(a=MiitApp.get("miit-page-store")),s||(s=MiitApp.get("miit-page-actions")),t||(t=MiitApp.get("miit-router"),t.routes.set("/([a-zA-Z0-9_-]{0,})",function(e){var t=e||o;r["menu-team"]=t,s.changeMainPage(t)}))},componentDidMount:function(){n.addLoggedInListener(this._onChange),a.addMainPageChangedListener(this._onChange)},componentWillUnmount:function(){n.removeLoggedInListener(this._onChange),a.removeMainPageChangedListener(this._onChange)},_onChange:function(){var e=a.getCurrentMainPage();e?this.isMounted()&&this.setState({page:e}):setTimeout(function(){s.changeMainPage("not-found")})},render:function(){return e.createElement("div",{className:"page bg-grey lighten-5"},e.createElement(MiitComponents.MenuTeam,null),e.createElement("div",{className:"main"},this.state.page),e.createElement(MiitComponents.NotificationsContainer,null))}})}()}(React,Flux,Router);
//# sourceMappingURL=app.min.js.map